<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis Resultados - Sintonía Política</title>
    <link rel="icon" type="image/x-icon" href="images/icon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/pages.css">
</head>
<body>
    <!-- Navbar para Mis Resultados -->
    <nav class="results-navbar">
        <div class="navbar-content">
            <div class="navbar-logo">
                <img src="images/Logo SP-11.png" alt="Sintonía Política" class="logo-img">
            </div>
            <div class="navbar-links">
                <a href="justificaciones.html" class="nav-link">Justificaciones</a>
                <a href="index.html" class="nav-link">Volver al Inicio</a>
            </div>
        </div>
    </nav>

    <div class="page-header">
        <h1 class="page-title">Mis Respuestas</h1>
        <p class="page-subtitle">
            Aquí puedes revisar todas las respuestas que diste durante el test, 
            con tu selección resaltada en azul.
        </p>
    </div>

    <div class="my-results-container">
        <div id="my-results-content">
            <!-- Las preguntas y respuestas se cargarán aquí dinámicamente -->
        </div>
    </div>

    <script src="scripts/data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            generateMyResults();
        });

        function showSurveyInfo() {
            alert('Esta es una encuesta independiente que busca ayudarte a conocer tu afinidad con las propuestas políticas de los candidatos presidenciales.');
        }

        function generateMyResults() {
            const container = document.getElementById('my-results-content');
            
            // Verificar si hay resultados guardados
            const savedAnswers = localStorage.getItem('userAnswers');
            
            if (!savedAnswers) {
                showNoResultsMessage(container);
                return;
            }

            const userAnswers = JSON.parse(savedAnswers);
            const { questions } = window.testData;

            // Verificar que los datos estén cargados
            if (!questions) {
                console.error('Error: No se pudieron cargar los datos');
                container.innerHTML = '<p>Error al cargar los datos. Por favor, recarga la página.</p>';
                return;
            }

            questions.forEach((question, questionIndex) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-matrix';
                
                const questionTitle = document.createElement('div');
                questionTitle.className = 'question-title';
                questionTitle.innerHTML = `<strong>Pregunta ${questionIndex + 1}:</strong> ${question.text}`;
                
                const answersGrid = document.createElement('div');
                answersGrid.className = 'answers-matrix';
                
                // Crear las 5 opciones de respuesta
                const answerOptions = [
                    { value: -2, text: 'Muy en desacuerdo' },
                    { value: -1, text: 'En desacuerdo' },
                    { value: 0, text: 'Neutral' },
                    { value: 1, text: 'De acuerdo' },
                    { value: 2, text: 'Muy de acuerdo' }
                ];

                answerOptions.forEach(option => {
                    const answerDiv = document.createElement('div');
                    answerDiv.className = `answer-option`;
                    answerDiv.setAttribute('data-value', option.value);
                    
                    // Verificar si esta es la respuesta seleccionada
                    const userAnswer = userAnswers[questionIndex];
                    const isSelected = userAnswer === option.value;
                    
                    if (isSelected) {
                        answerDiv.classList.add('selected');
                    }
                    
                    answerDiv.innerHTML = `
                        <div class="answer-text">${option.text}</div>
                        <div class="answer-value">${isSelected ? '✓' : ''}</div>
                    `;
                    
                    answersGrid.appendChild(answerDiv);
                });
                
                questionDiv.appendChild(questionTitle);
                questionDiv.appendChild(answersGrid);
                container.appendChild(questionDiv);
            });
        }

        function showNoResultsMessage(container) {
            container.innerHTML = `
                <div class="no-results-message">
                    <h3>No hay resultados disponibles</h3>
                    <p>Primero debes completar el test para ver tus respuestas.</p>
                    <a href="index.html" class="btn btn-primary">Realizar Test</a>
                </div>
            `;
        }
    </script>
</body>
</html>
